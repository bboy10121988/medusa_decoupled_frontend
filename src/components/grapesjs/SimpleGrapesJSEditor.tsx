"use client"import React, { useEffect, useRef, useState } from 'react'const SimpleGrapesJSEditor: React.FC = () => {  const editorContainerRef = useRef<HTMLDivElement>(null)  const [status, setStatus] = useState('正在初始化...')  const [error, setError] = useState<string | null>(null)  useEffect(() => {    let mounted = true    const initEditor = async () => {      try {        setStatus('正在載入 GrapesJS...')                // 短暫延遲確保 DOM 渲染完成        await new Promise(resolve => setTimeout(resolve, 500))                if (!mounted) return                if (!editorContainerRef.current) {          throw new Error('編輯器容器元素未找到')        }        setStatus('正在初始化編輯器...')                // 動態導入 GrapesJS 和插件        const [{ default: grapesjs }, { default: blocksBasic }] = await Promise.all([          import('grapesjs'),          import('grapesjs-blocks-basic')        ])                if (!mounted) return        console.log('🚀 開始初始化 GrapesJS 編輯器...')        // 初始化編輯器        const editor = grapesjs.init({          container: editorContainerRef.current,          height: '100%',          width: 'auto',                    // 啟用基本插件          plugins: [blocksBasic],                    // 禁用存儲管理器          storageManager: false,                    // 預設內容          components: `            <div style="padding: 40px; font-family: Arial, sans-serif; text-align: center;">              <h1 style="color: #2c3e50; margin-bottom: 20px; font-size: 2.5em;">                🎉 GrapesJS 編輯器成功載入！              </h1>              <p style="color: #7f8c8d; font-size: 1.2em; line-height: 1.6; margin-bottom: 30px;">                這是一個功能完整的視覺化網頁編輯器              </p>              <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; margin: 30px auto; max-width: 600px;">                <h3 style="margin: 0 0 15px 0;">✨ 編輯器功能</h3>                <ul style="text-align: left; margin: 0; padding-left: 20px; line-height: 1.8;">                  <li>🖱️ 點擊任何元素進行選擇</li>                  <li>✏️ 雙擊文字進行編輯</li>                  <li>🎨 右側面板調整樣式</li>                  <li>📱 響應式設計支援</li>                </ul>              </div>              <div style="background: #ecf0f1; padding: 25px; border-radius: 8px; border-left: 4px solid #3498db;">                <p style="margin: 0; color: #2c3e50; font-style: italic;">                  💡 提示：嘗試修改這些文字和樣式，體驗編輯器的強大功能！                </p>              </div>            </div>          `        })        // 監聽載入完成事件        editor.on('load', () => {          if (mounted) {            setStatus('編輯器已就緒！')            console.log('✅ GrapesJS 編輯器載入完成')          }        })        // 監聽錯誤        editor.on('error', (err: any) => {          console.error('編輯器錯誤:', err)        })      } catch (err) {        console.error('初始化失敗:', err)        if (mounted) {          setError(err instanceof Error ? err.message : '未知錯誤')        }      }    }    initEditor()    return () => {      mounted = false    }  }, [])  if (error) {    return (      <div style={{        display: 'flex',        flexDirection: 'column',        alignItems: 'center',        justifyContent: 'center',        height: '100vh',        background: '#f8f9fa',        fontFamily: 'Arial, sans-serif'      }}>        <div style={{          background: 'white',          padding: '40px',          borderRadius: '12px',          boxShadow: '0 4px 20px rgba(0,0,0,0.1)',          textAlign: 'center',          maxWidth: '500px'        }}>          <div style={{ fontSize: '48px', marginBottom: '20px' }}>❌</div>          <h2 style={{ color: '#e74c3c', marginBottom: '15px' }}>編輯器載入失敗</h2>          <p style={{ color: '#7f8c8d', marginBottom: '25px', lineHeight: '1.6' }}>            {error}          </p>          <button            onClick={() => window.location.reload()}            style={{              background: '#3498db',              color: 'white',              border: 'none',              padding: '12px 24px',              borderRadius: '6px',              cursor: 'pointer',              fontSize: '16px',              fontWeight: '500'            }}          >            🔄 重新載入          </button>        </div>      </div>    )  }  return (    <div style={{ height: '100vh', display: 'flex', flexDirection: 'column', fontFamily: 'Arial, sans-serif' }}>      {/* 頂部狀態欄 */}      <div style={{        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',        color: 'white',        padding: '15px 25px',        display: 'flex',        alignItems: 'center',        justifyContent: 'space-between',        boxShadow: '0 2px 10px rgba(0,0,0,0.1)'      }}>        <div>          <h1 style={{ margin: 0, fontSize: '20px', fontWeight: '600' }}>            🎨 GrapesJS 視覺編輯器          </h1>          <p style={{ margin: '5px 0 0 0', fontSize: '14px', opacity: 0.9 }}>            專業級網頁視覺化編輯工具          </p>        </div>        <div style={{          background: 'rgba(255,255,255,0.2)',          padding: '8px 16px',          borderRadius: '20px',          fontSize: '14px'        }}>          {status}        </div>      </div>      {/* 主要編輯器容器 */}      <div style={{ flex: 1, position: 'relative', background: '#ffffff' }}>        <div           ref={editorContainerRef}          style={{             height: '100%',             width: '100%',            border: 'none'          }}        >          {/* 載入指示器 */}          {!error && (            <div style={{              display: 'flex',              alignItems: 'center',              justifyContent: 'center',              height: '100%',              color: '#6c757d'            }}>              <div style={{                textAlign: 'center'              }}>                <div style={{                  width: '50px',                  height: '50px',                  border: '5px solid #f3f3f3',                  borderTop: '5px solid #667eea',                  borderRadius: '50%',                  animation: 'spin 1s linear infinite',                  margin: '0 auto 20px'                }}></div>                <p>{status}</p>              </div>            </div>          )}        </div>      </div>      {/* CSS 動畫和樣式 */}      <style jsx>{`        @keyframes spin {          0% { transform: rotate(0deg); }          100% { transform: rotate(360deg); }        }      `}</style>      {/* GrapesJS 全局樣式覆蓋 */}      <style jsx global>{`        .gjs-frame {          border: none ;        }                .gjs-cv-canvas {          background: #ffffff ;        }                .gjs-toolbar {          background: rgba(255,255,255,0.95) ;          border: 1px solid #e9ecef ;          border-radius: 6px ;          box-shadow: 0 2px 10px rgba(0,0,0,0.1) ;        }      `}</style>    </div>  )}export default SimpleGrapesJSEditor