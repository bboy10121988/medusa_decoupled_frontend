import { createClient } from '@sanity/client'
import * as dotenv from 'dotenv'
import { resolve } from 'path'

dotenv.config({ path: resolve(__dirname, '../.env.local') })

const client = createClient({
    projectId: process.env.NEXT_PUBLIC_SANITY_PROJECT_ID || '',
    dataset: process.env.NEXT_PUBLIC_SANITY_DATASET || '',
    apiVersion: '2024-01-01',
    useCdn: false,
    token: process.env.SANITY_API_TOKEN
})

// æ‰‹å‹•ç¿»è­¯å°ç…§è¡¨
const translations: Record<string, string> = {
    // ç”·å£«æ´—å‰ªé«®å«é ­çš®å™´éœ§
    'ç”·å£«æ´—å‰ªé«®å«é ­çš®å™´éœ§å°ˆæ¥­æœå‹™': 'ãƒ¡ãƒ³ã‚ºã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ãƒ»ã‚«ãƒƒãƒˆï¼ˆé ­çš®ã‚¹ãƒ—ãƒ¬ãƒ¼ä»˜ãï¼‰ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚µãƒ¼ãƒ“ã‚¹',
    'æˆ‘å€‘æä¾›å°ˆæ¥­çš„ç”·å£«æ´—å‰ªé«®æœå‹™ï¼ŒåŒ…å«é ­çš®å™´éœ§è­·ç†ã€‚': 'é ­çš®ã‚¹ãƒ—ãƒ¬ãƒ¼ã‚±ã‚¢ã‚’å«ã‚€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªãƒ¡ãƒ³ã‚ºã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ãƒ»ã‚«ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚',
    'æœå‹™å…§å®¹åŒ…æ‹¬ï¼š': 'ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹ï¼š',
    'å°ˆæ¥­æ´—é«®': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼',
    'ç²¾æº–å‰ªé«®': 'ç²¾å¯†ã‚«ãƒƒãƒˆ',
    'é ­çš®å™´éœ§è­·ç†': 'é ­çš®ã‚¹ãƒ—ãƒ¬ãƒ¼ã‚±ã‚¢',
    'é€ å‹å»ºè­°': 'ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã‚¢ãƒ‰ãƒã‚¤ã‚¹',
    'é©åˆæ‰€æœ‰é«®è³ªï¼Œè®“æ‚¨çš„é ­é«®ä¿æŒå¥åº·äº®éº—ã€‚': 'ã™ã¹ã¦ã®é«ªè³ªã«å¯¾å¿œã—ã€å¥åº·ã§ç¾ã—ã„é«ªã‚’ä¿ã¡ã¾ã™ã€‚',

    // æ´—å‰ªä¿®çœ‰
    'æ´—å‰ªä¿®çœ‰å…¨æ–¹ä½æœå‹™': 'ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ãƒ»ã‚«ãƒƒãƒˆãƒ»çœ‰ã‚«ãƒƒãƒˆç·åˆã‚µãƒ¼ãƒ“ã‚¹',
    'å®Œæ•´çš„ç”·å£«ç†å®¹æœå‹™ï¼ŒåŒ…å«æ´—é«®ã€å‰ªé«®å’Œä¿®çœ‰ã€‚': 'ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ã€ã‚«ãƒƒãƒˆã€çœ‰ã‚«ãƒƒãƒˆã‚’å«ã‚€å®Œå…¨ãªãƒ¡ãƒ³ã‚ºã‚°ãƒ«ãƒ¼ãƒŸãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã€‚',
    'å°ˆæ¥­ä¿®çœ‰': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«çœ‰ã‚«ãƒƒãƒˆ',
    'æ‰“é€ å®Œç¾é€ å‹': 'å®Œç’§ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½œã‚‹',
    'è®“æ‚¨å¾é ­åˆ°è‡‰éƒ½å±•ç¾æœ€ä½³ç‹€æ…‹ã€‚': 'é ­ã‹ã‚‰é¡”ã¾ã§æœ€é«˜ã®çŠ¶æ…‹ã‚’æ¼”å‡ºã—ã¾ã™ã€‚',

    // ç”·å£«ç‡™é«®
    'å°ˆæ¥­ç”·å£«ç‡™é«®æœå‹™': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ¡ãƒ³ã‚ºãƒ‘ãƒ¼ãƒã‚µãƒ¼ãƒ“ã‚¹',
    'ä½¿ç”¨é«˜å“è³ªç‡™é«®ç”¢å“ï¼Œç‚ºæ‚¨æ‰“é€ ç†æƒ³é«®å‹ã€‚': 'é«˜å“è³ªãªãƒ‘ãƒ¼ãƒè£½å“ã‚’ä½¿ç”¨ã—ã€ç†æƒ³çš„ãªãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚',
    'å†·ç‡™': 'ã‚³ãƒ¼ãƒ«ãƒ‰ãƒ‘ãƒ¼ãƒ',
    'ç†±ç‡™': 'ãƒ›ãƒƒãƒˆãƒ‘ãƒ¼ãƒ',
    'é€ å‹ç‡™': 'ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ãƒ‘ãƒ¼ãƒ',
    'æ ¹æ“šæ‚¨çš„é«®è³ªå’Œéœ€æ±‚ï¼Œæä¾›æœ€é©åˆçš„ç‡™é«®æ–¹æ¡ˆã€‚': 'é«ªè³ªã¨ãƒ‹ãƒ¼ã‚ºã«åˆã‚ã›ã¦ã€æœ€é©ãªãƒ‘ãƒ¼ãƒãƒ—ãƒ©ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚',

    // é ­çš®è­·ç†
    'å°ˆæ¥­é ­çš®è­·ç†æœå‹™': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«é ­çš®ã‚±ã‚¢ã‚µãƒ¼ãƒ“ã‚¹',
    'æ·±å±¤æ¸…æ½”é ­çš®ï¼Œä¿ƒé€²é ­é«®å¥åº·ç”Ÿé•·ã€‚': 'é ­çš®ã‚’æ·±ãã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã—ã€å¥åº·ãªé«ªã®æˆé•·ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚',
    'é ­çš®æª¢æ¸¬': 'é ­çš®è¨ºæ–­',
    'æ·±å±¤æ¸…æ½”': 'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°',
    'é ­çš®æŒ‰æ‘©': 'é ­çš®ãƒãƒƒã‚µãƒ¼ã‚¸',
    'ç‡Ÿé¤Šè­·ç†': 'æ „é¤Šã‚±ã‚¢',
    'æ”¹å–„é ­çš®ç’°å¢ƒï¼Œé é˜²è½é«®å•é¡Œã€‚': 'é ­çš®ç’°å¢ƒã‚’æ”¹å–„ã—ã€æŠœã‘æ¯›ã‚’äºˆé˜²ã—ã¾ã™ã€‚',

    // ç”·å£«å‰ªé«®
    'å°ˆæ¥­ç”·å£«å‰ªé«®æœå‹™': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ¡ãƒ³ã‚ºã‚«ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹',
    'ç”±ç¶“é©—è±å¯Œçš„è¨­è¨ˆå¸«ç‚ºæ‚¨æ‰“é€ å°ˆå±¬é«®å‹ã€‚': 'çµŒé¨“è±Šå¯Œãªã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆãŒã‚ãªãŸå°‚ç”¨ã®ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚',
    'å•†å‹™é«®å‹': 'ãƒ“ã‚¸ãƒã‚¹ã‚¹ã‚¿ã‚¤ãƒ«',
    'æ™‚å°šé€ å‹': 'ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«',
    'å€‹æ€§è¨­è¨ˆ': 'å€‹æ€§çš„ãƒ‡ã‚¶ã‚¤ãƒ³',
    'ä¾æ“šè‡‰å‹å’Œå€‹äººé¢¨æ ¼ï¼Œé‡èº«æ‰“é€ æœ€é©åˆæ‚¨çš„é«®å‹ã€‚': 'é¡”ã®å½¢ã¨å€‹äººã®ã‚¹ã‚¿ã‚¤ãƒ«ã«åˆã‚ã›ã¦ã€æœ€é©ãªãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚',

    // ç”·å£«æŸ“é«®
    'å°ˆæ¥­ç”·å£«æŸ“é«®æœå‹™': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ¡ãƒ³ã‚ºãƒ˜ã‚¢ã‚«ãƒ©ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹',
    'ä½¿ç”¨é ‚ç´šæŸ“é«®ç”¢å“ï¼Œå®‰å…¨åˆæŒä¹…ã€‚': 'ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã®ãƒ˜ã‚¢ã‚«ãƒ©ãƒ¼è£½å“ã‚’ä½¿ç”¨ã—ã€å®‰å…¨ã§é•·æŒã¡ã—ã¾ã™ã€‚',
    'å…¨æŸ“': 'ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼',
    'æŒ‘æŸ“': 'ãƒã‚¤ãƒ©ã‚¤ãƒˆ',
    'ç™½é«®æŸ“': 'ç™½é«ªæŸ“ã‚',
    'æ™‚å°šæŸ“é«®': 'ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã‚«ãƒ©ãƒ¼',
    'å°ˆæ¥­èª¿è‰²ï¼Œå±•ç¾æ‚¨çš„å€‹äººé­…åŠ›ã€‚': 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚«ãƒ©ãƒ¼ãƒªãƒ³ã‚°ã§ã€ã‚ãªãŸã®å€‹æ€§çš„ãªé­…åŠ›ã‚’å¼•ãå‡ºã—ã¾ã™ã€‚',
}

async function translateBlogContent() {
    console.log('ğŸŒ é–‹å§‹æ‰‹å‹•ç¿»è­¯æ—¥æ–‡éƒ¨è½æ ¼æ–‡ç« å…§å®¹...\n')

    const query = `*[_type == "post" && language == "ja-JP"] | order(publishedAt desc) {
    _id,
    title,
    "slug": slug.current,
    body
  }`

    const posts = await client.fetch(query)
    console.log(`æ‰¾åˆ° ${posts.length} ç¯‡æ—¥æ–‡æ–‡ç« \n`)

    for (const post of posts) {
        console.log(`\nğŸ“„ è™•ç†: ${post.title}`)

        if (!post.body || post.body.length === 0) {
            console.log('   â­ï¸  è·³éï¼šæ²’æœ‰å…§å®¹')
            continue
        }

        const translatedBody = post.body.map((block: any) => {
            if (block._type === 'block' && block.children) {
                return {
                    ...block,
                    children: block.children.map((child: any) => {
                        if (child._type === 'span' && child.text) {
                            const translated = translations[child.text] || child.text
                            if (translated !== child.text) {
                                console.log(`   âœ“ ç¿»è­¯: ${child.text.substring(0, 30)}... â†’ ${translated.substring(0, 30)}...`)
                            }
                            return {
                                ...child,
                                text: translated
                            }
                        }
                        return child
                    })
                }
            }
            return block
        })

        try {
            await client
                .patch(post._id)
                .set({ body: translatedBody })
                .commit()
            console.log('   âœ… å·²æ›´æ–°åˆ° Sanity')
        } catch (error) {
            console.error(`   âŒ éŒ¯èª¤:`, error)
        }
    }

    console.log('\nâœ¨ ç¿»è­¯å®Œæˆï¼')
}

translateBlogContent().catch(console.error)
